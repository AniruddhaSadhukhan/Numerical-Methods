#include<stdio.h>
#include <math.h>
#define ERROR 0.0001
#define F(x,y) (3*(x)*(x)+1)

void modified_euler_ode(void);

int main()
{
	printf("Program to estimate solution of first order differential equation ");
	printf("using Euler's Method ");
	printf("\n               -------------by Aniruddha\n");
	//y(x+h)[0]=y(x) + h * y'(x,y(x))
	//y(x+h)[n+1]=y(x) + h/2 * {y'(x,y(x)) + y'(x+h,y(x+h)[n])} until |y[n]-y[n+1]| < error
	modified_euler_ode();
	return 0;
}

void modified_euler_ode()
{
	float x,y,yn,ynn,xp,h;
	int n,i,count;
	
	printf("\nEnter initial value of x and y:");
	scanf("%f%f",&x,&y);
	
	printf("\nEnter x at which y is required:");
	scanf("%f",&xp);
	
	printf("Enter the step size:");
	scanf("%f",&h);
	
	n =(int)((xp-x)/h+0.5);

	for (i=1;i<=n;i++)
	{
		ynn=y + h * F(x,y);
		count=0;
		printf("\n\ny(%4f)[%d]=%4f + %4f * %4f = %4f\n",x+h,count,y,h,F(x,y),ynn);
		do
		{
			yn=ynn;
			count++;
			ynn=y+(h/2)*(F(x,y)+F(x+h,yn));
			printf("y(%4f)[%d]=%4f + %4f * (%4f + %4f) = %4f\n",x+h,count,y,h/2,F(x,y),F(x+h,yn),ynn);
		}while(count<10 && fabs(ynn-yn)>ERROR);
		
		y=ynn;
		x=x+h;
	}
	
	printf("\ny(%f)=%f\n",xp,y);
	return;
}
/*
Program to estimate solution of first order differential equation using Euler's Method 
               -------------by Aniruddha

Enter initial value of x and y:5 10

Enter x at which y is required:15
Enter the step size:1


y(6.000000)[0]=10.000000 + 1.000000 * 76.000000 = 86.000000
y(6.000000)[1]=10.000000 + 0.500000 * (76.000000 + 109.000000) = 102.500000
y(6.000000)[2]=10.000000 + 0.500000 * (76.000000 + 109.000000) = 102.500000


y(7.000000)[0]=102.500000 + 1.000000 * 109.000000 = 211.500000
y(7.000000)[1]=102.500000 + 0.500000 * (109.000000 + 148.000000) = 231.000000
y(7.000000)[2]=102.500000 + 0.500000 * (109.000000 + 148.000000) = 231.000000


y(8.000000)[0]=231.000000 + 1.000000 * 148.000000 = 379.000000
y(8.000000)[1]=231.000000 + 0.500000 * (148.000000 + 193.000000) = 401.500000
y(8.000000)[2]=231.000000 + 0.500000 * (148.000000 + 193.000000) = 401.500000


y(9.000000)[0]=401.500000 + 1.000000 * 193.000000 = 594.500000
y(9.000000)[1]=401.500000 + 0.500000 * (193.000000 + 244.000000) = 620.000000
y(9.000000)[2]=401.500000 + 0.500000 * (193.000000 + 244.000000) = 620.000000


y(10.000000)[0]=620.000000 + 1.000000 * 244.000000 = 864.000000
y(10.000000)[1]=620.000000 + 0.500000 * (244.000000 + 301.000000) = 892.500000
y(10.000000)[2]=620.000000 + 0.500000 * (244.000000 + 301.000000) = 892.500000


y(11.000000)[0]=892.500000 + 1.000000 * 301.000000 = 1193.500000
y(11.000000)[1]=892.500000 + 0.500000 * (301.000000 + 364.000000) = 1225.000000
y(11.000000)[2]=892.500000 + 0.500000 * (301.000000 + 364.000000) = 1225.000000


y(12.000000)[0]=1225.000000 + 1.000000 * 364.000000 = 1589.000000
y(12.000000)[1]=1225.000000 + 0.500000 * (364.000000 + 433.000000) = 1623.500000
y(12.000000)[2]=1225.000000 + 0.500000 * (364.000000 + 433.000000) = 1623.500000


y(13.000000)[0]=1623.500000 + 1.000000 * 433.000000 = 2056.500000
y(13.000000)[1]=1623.500000 + 0.500000 * (433.000000 + 508.000000) = 2094.000000
y(13.000000)[2]=1623.500000 + 0.500000 * (433.000000 + 508.000000) = 2094.000000


y(14.000000)[0]=2094.000000 + 1.000000 * 508.000000 = 2602.000000
y(14.000000)[1]=2094.000000 + 0.500000 * (508.000000 + 589.000000) = 2642.500000
y(14.000000)[2]=2094.000000 + 0.500000 * (508.000000 + 589.000000) = 2642.500000


y(15.000000)[0]=2642.500000 + 1.000000 * 589.000000 = 3231.500000
y(15.000000)[1]=2642.500000 + 0.500000 * (589.000000 + 676.000000) = 3275.000000
y(15.000000)[2]=2642.500000 + 0.500000 * (589.000000 + 676.000000) = 3275.000000

y(15.000000)=3275.000000

*/
